import{_ as pe,O as Ce,P as we,V as be,W as ye,X as Se,Y as ze,Z as Ve,$ as $e,a0 as V,a1 as Be,a2 as Le,a3 as ee,a4 as Re,a5 as Ie,a6 as He}from"./index-d7e55478.7e7d2063.js";import{U as Ne}from"./index-1c6e8058.e6f06c44.js";import{d as le,a5 as Te,j as d,m,w as P,h as ke,D as A,o as w,c as $,n as D,H as xe,t as j,C as W,G as B,B as G,z as Ee,E as X,r as Fe,i as ae,A as Me}from"./framework.6f649eb3.js";const Oe=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","white-space","overflow-wrap","width"],Pe=e=>{const l={};return Oe.forEach(v=>{l[v]=e.getPropertyValue(v)}),l},Ae=le({name:"Textarea",components:{ResizeObserver:Ce,IconHover:we,IconClose:be},inheritAttrs:!1,props:{modelValue:String,defaultValue:{type:String,default:""},placeholder:String,disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},maxLength:{type:[Number,Object],default:0},showWordLimit:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},autoSize:{type:[Boolean,Object],default:!1},wordLength:{type:Function},wordSlice:{type:Function}},emits:{"update:modelValue":e=>!0,input:(e,l)=>!0,change:(e,l)=>!0,clear:e=>!0,focus:e=>!0,blur:e=>!0},setup(e,{emit:l,attrs:v}){const{disabled:p,error:h,modelValue:c}=Te(e),f=ye("textarea"),{mergedDisabled:g,mergedError:L,eventHandlers:o}=Se({disabled:p,error:h}),u=d(),Y=d(),b=d(),Z=d(),R=d(e.defaultValue),i=m(()=>{var a;return(a=c.value)!=null?a:R.value}),[te,oe]=ze(u);P(c,a=>{(Ve(a)||$e(a))&&(R.value="")});const y=m(()=>V(e.maxLength)&&!!e.maxLength.errorOnly),s=m(()=>V(e.maxLength)?e.maxLength.length:e.maxLength),S=a=>{var t;return Be(e.wordLength)?e.wordLength(a):(t=a.length)!=null?t:0},q=m(()=>S(i.value)),ne=m(()=>L.value||!!(s.value&&y.value&&q.value>s.value)),C=d(!1),I=d(!1),re=m(()=>e.allowClear&&!g.value&&i.value),H=d(!1),J=d(""),N=()=>{te(),ae(()=>{u.value&&i.value!==u.value.value&&(u.value.value=i.value,oe())})},z=(a,t=!0)=>{var n,r;s.value&&!y.value&&S(a)>s.value&&(a=(r=(n=e.wordSlice)==null?void 0:n.call(e,a,s.value))!=null?r:a.slice(0,s.value)),R.value=a,t&&l("update:modelValue",a),N()};let T=i.value;const K=(a,t)=>{var n,r;a!==T&&(T=a,l("change",a,t),(r=(n=o.value)==null?void 0:n.onChange)==null||r.call(n,t))},ue=a=>{var t,n;I.value=!0,T=i.value,l("focus",a),(n=(t=o.value)==null?void 0:t.onFocus)==null||n.call(t,a)},se=a=>{var t,n;I.value=!1,l("blur",a),(n=(t=o.value)==null?void 0:t.onBlur)==null||n.call(t,a),K(i.value,a)},ie=a=>{var t,n;const{value:r}=a.target;if(a.type==="compositionend"){if(H.value=!1,J.value="",s.value&&!y.value&&i.value.length>=s.value&&S(r)>s.value){N();return}l("input",r,a),z(r),(n=(t=o.value)==null?void 0:t.onInput)==null||n.call(t,a)}else H.value=!0},de=a=>{var t,n;const{value:r}=a.target;if(H.value)J.value=r;else{if(s.value&&!y.value&&i.value.length>=s.value&&S(r)>s.value&&a.inputType==="insertText"){N();return}l("input",r,a),z(r),(n=(t=o.value)==null?void 0:t.onInput)==null||n.call(t,a)}},ve=a=>{z(""),K("",a),l("clear",a)};P(c,a=>{a!==i.value&&z(a??"",!1)});const fe=a=>Le(v,ee),me=a=>Re(v,ee),ce=m(()=>[`${f}-wrapper`,{[`${f}-focus`]:I.value,[`${f}-disabled`]:g.value,[`${f}-error`]:ne.value,[`${f}-scroll`]:C.value}]);let Q;const k=d(0),x=d(0),E=m(()=>!V(e.autoSize)||!e.autoSize.minRows?0:e.autoSize.minRows*k.value+x.value),F=m(()=>!V(e.autoSize)||!e.autoSize.maxRows?0:e.autoSize.maxRows*k.value+x.value),M=()=>{const a=Pe(Q);k.value=Number.parseInt(a["line-height"]||0,10),x.value=Number.parseInt(a["border-width"]||0,10)*2+Number.parseInt(a["padding-top"]||0,10)+Number.parseInt(a["padding-bottom"]||0,10),Z.value=a,ae(()=>{var t;const n=(t=b.value)==null?void 0:t.offsetHeight;let r=n??0,_="hidden";E.value&&r<E.value&&(r=E.value),F.value&&r>F.value&&(r=F.value,_="auto"),Y.value={height:`${r}px`,resize:"none",overflow:_}})};ke(()=>{u.value&&(Q=window.getComputedStyle(u.value),e.autoSize&&M()),O()});const ge=()=>{e.autoSize&&b.value&&M(),O()},he=a=>{u.value&&a.target!==u.value&&(a.preventDefault(),u.value.focus())},O=()=>{u.value&&(u.value.scrollHeight>u.value.offsetHeight?C.value||(C.value=!0):C.value&&(C.value=!1))};return P(i,()=>{e.autoSize&&b.value&&M(),O()}),{prefixCls:f,wrapperCls:ce,textareaRef:u,textareaStyle:Y,mirrorRef:b,mirrorStyle:Z,computedValue:i,showClearBtn:re,valueLength:q,computedMaxLength:s,mergedDisabled:g,getWrapperAttrs:fe,getTextareaAttrs:me,handleInput:de,handleFocus:ue,handleBlur:se,handleComposition:ie,handleClear:ve,handleResize:ge,handleMousedown:he}},methods:{focus(){var e;(e=this.$refs.textareaRef)==null||e.focus()},blur(){var e;(e=this.$refs.textareaRef)==null||e.blur()}}}),De=["disabled","value","placeholder"];function je(e,l,v,p,h,c){const f=A("resize-observer"),g=A("icon-close"),L=A("icon-hover");return w(),$("div",X(e.getWrapperAttrs(e.$attrs),{class:e.wrapperCls,onMousedown:l[7]||(l[7]=(...o)=>e.handleMousedown&&e.handleMousedown(...o))}),[e.autoSize?(w(),$("div",{key:0,ref:"mirrorRef",class:D(`${e.prefixCls}-mirror`),style:xe(e.mirrorStyle)},j(`${e.computedValue}
`),7)):W("v-if",!0),B(f,{onResize:e.handleResize},{default:G(()=>[Ee("textarea",X({ref:"textareaRef"},e.getTextareaAttrs(e.$attrs),{disabled:e.mergedDisabled,class:e.prefixCls,style:e.textareaStyle,value:e.computedValue,placeholder:e.placeholder,onInput:l[0]||(l[0]=(...o)=>e.handleInput&&e.handleInput(...o)),onFocus:l[1]||(l[1]=(...o)=>e.handleFocus&&e.handleFocus(...o)),onBlur:l[2]||(l[2]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onCompositionstart:l[3]||(l[3]=(...o)=>e.handleComposition&&e.handleComposition(...o)),onCompositionupdate:l[4]||(l[4]=(...o)=>e.handleComposition&&e.handleComposition(...o)),onCompositionend:l[5]||(l[5]=(...o)=>e.handleComposition&&e.handleComposition(...o))}),null,16,De)]),_:1},8,["onResize"]),Fe(e.$slots,"suffix"),e.computedMaxLength&&e.showWordLimit?(w(),$("div",{key:1,class:D(`${e.prefixCls}-word-limit`)},j(e.valueLength)+"/"+j(e.computedMaxLength),3)):W("v-if",!0),e.showClearBtn?(w(),$("div",{key:2,class:D(`${e.prefixCls}-clear-btn`),onClick:l[6]||(l[6]=(...o)=>e.handleClear&&e.handleClear(...o))},[B(L,null,{default:G(()=>[B(g)]),_:1})],2)):W("v-if",!0)],16)}var U=pe(Ae,[["render",je]]);const We=Object.assign(U,{install:(e,l)=>{Ie(e,l);const v=He(l);e.component(v+U.name,U)}}),Ye=le({name:"Textarea",__name:"index",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:l}){const v=e,p=m({get:()=>v.modelValue,set:h=>{l("update:modelValue",h)}});return(h,c)=>{const f=We;return w(),Me(Ne,null,{default:G(()=>[B(f,X({modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=g=>p.value=g)},h.$attrs),null,16,["modelValue"])]),_:1})}}});export{Ye as default};
