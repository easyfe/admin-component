import{J as Se,K as ze,L as Ve,N as Be,O as Le,P as $e,Q as Ie,W as Oe,X as Re,Y as B,Z as xe,a0 as Pe,a1 as te,a2 as Ne,a3 as Te,a4 as Ee}from"./index-e5bb41c5.c7ba2fae.js";import{U as He}from"./index-a973a4fc.f1d6f10a.js";import{d as ue,a3 as Ae,i as f,l as m,w as M,f as Fe,D as k,o as y,c as L,n as j,H as Me,t as D,C as W,G as $,B as _,z as ke,E as G,r as je,h as le,A as De}from"./framework.83c44ddb.js";const We=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","white-space","overflow-wrap","width"],Ue=e=>{const t={};return We.forEach(o=>{t[o]=e.getPropertyValue(o)}),t};var _e=Object.defineProperty,oe=Object.getOwnPropertySymbols,Ge=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable,ne=(e,t,o)=>t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,re=(e,t)=>{for(var o in t||(t={}))Ge.call(t,o)&&ne(e,o,t[o]);if(oe)for(var o of oe(t))Je.call(t,o)&&ne(e,o,t[o]);return e};const Ke=ue({name:"Textarea",components:{ResizeObserver:ze,IconHover:Ve,IconClose:Be},inheritAttrs:!1,props:{modelValue:String,defaultValue:{type:String,default:""},placeholder:String,disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},maxLength:{type:[Number,Object],default:0},showWordLimit:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},autoSize:{type:[Boolean,Object],default:!1},wordLength:{type:Function},wordSlice:{type:Function},textareaAttrs:{type:Object}},emits:{"update:modelValue":e=>!0,input:(e,t)=>!0,change:(e,t)=>!0,clear:e=>!0,focus:e=>!0,blur:e=>!0},setup(e,{emit:t,attrs:o}){const{disabled:w,error:g,modelValue:c}=Ae(e),v=Le("textarea"),{mergedDisabled:p,mergedError:h,eventHandlers:n}=$e({disabled:w,error:g}),s=f(),J=f(),b=f(),K=f(),I=f(e.defaultValue),d=m(()=>{var a;return(a=c.value)!=null?a:I.value}),[se,ie]=Ie(s);M(c,a=>{(Oe(a)||Re(a))&&(I.value="")});const S=m(()=>B(e.maxLength)&&!!e.maxLength.errorOnly),i=m(()=>B(e.maxLength)?e.maxLength.length:e.maxLength),z=a=>{var l;return xe(e.wordLength)?e.wordLength(a):(l=a.length)!=null?l:0},Q=m(()=>z(d.value)),X=m(()=>h.value||!!(i.value&&S.value&&Q.value>i.value)),C=f(!1),O=f(!1),de=m(()=>e.allowClear&&!p.value&&d.value),R=f(!1),Y=f(""),x=()=>{se(),le(()=>{s.value&&d.value!==s.value.value&&(s.value.value=d.value,ie())})},V=(a,l=!0)=>{var r,u;i.value&&!S.value&&z(a)>i.value&&(a=(u=(r=e.wordSlice)==null?void 0:r.call(e,a,i.value))!=null?u:a.slice(0,i.value)),I.value=a,l&&t("update:modelValue",a),x()};let P=d.value;const Z=(a,l)=>{var r,u;a!==P&&(P=a,t("change",a,l),(u=(r=n.value)==null?void 0:r.onChange)==null||u.call(r,l))},ve=a=>{var l,r;O.value=!0,P=d.value,t("focus",a),(r=(l=n.value)==null?void 0:l.onFocus)==null||r.call(l,a)},fe=a=>{var l,r;O.value=!1,t("blur",a),(r=(l=n.value)==null?void 0:l.onBlur)==null||r.call(l,a),Z(d.value,a)},me=a=>{var l,r;const{value:u}=a.target;if(a.type==="compositionend"){if(R.value=!1,Y.value="",i.value&&!S.value&&d.value.length>=i.value&&z(u)>i.value){x();return}t("input",u,a),V(u),(r=(l=n.value)==null?void 0:l.onInput)==null||r.call(l,a)}else R.value=!0},ce=a=>{var l,r;const{value:u}=a.target;if(R.value)Y.value=u;else{if(i.value&&!S.value&&d.value.length>=i.value&&z(u)>i.value&&a.inputType==="insertText"){x();return}t("input",u,a),V(u),(r=(l=n.value)==null?void 0:l.onInput)==null||r.call(l,a)}},pe=a=>{V(""),Z("",a),t("clear",a)};M(c,a=>{a!==d.value&&V(a??"",!1)});const ge=a=>Pe(o,te),q=a=>Ne(o,te),he=q(),Ce=m(()=>{const a=re(re({},he),e.textareaAttrs);return X.value&&(a["aria-invalid"]=!0),a}),ye=m(()=>[`${v}-wrapper`,{[`${v}-focus`]:O.value,[`${v}-disabled`]:p.value,[`${v}-error`]:X.value,[`${v}-scroll`]:C.value}]);let ee;const N=f(0),T=f(0),E=m(()=>!B(e.autoSize)||!e.autoSize.minRows?0:e.autoSize.minRows*N.value+T.value),H=m(()=>!B(e.autoSize)||!e.autoSize.maxRows?0:e.autoSize.maxRows*N.value+T.value),A=()=>{const a=Ue(ee);N.value=Number.parseInt(a["line-height"]||0,10),T.value=Number.parseInt(a["border-width"]||0,10)*2+Number.parseInt(a["padding-top"]||0,10)+Number.parseInt(a["padding-bottom"]||0,10),K.value=a,le(()=>{var l;const r=(l=b.value)==null?void 0:l.offsetHeight;let u=r??0,ae="hidden";E.value&&u<E.value&&(u=E.value),H.value&&u>H.value&&(u=H.value,ae="auto"),J.value={height:`${u}px`,resize:"none",overflow:ae}})};Fe(()=>{s.value&&(ee=window.getComputedStyle(s.value),e.autoSize&&A()),F()});const we=()=>{e.autoSize&&b.value&&A(),F()},be=a=>{s.value&&a.target!==s.value&&(a.preventDefault(),s.value.focus())},F=()=>{s.value&&(s.value.scrollHeight>s.value.offsetHeight?C.value||(C.value=!0):C.value&&(C.value=!1))};return M(d,()=>{e.autoSize&&b.value&&A(),F()}),{prefixCls:v,wrapperCls:ye,textareaRef:s,textareaStyle:J,mirrorRef:b,mirrorStyle:K,computedValue:d,showClearBtn:de,valueLength:Q,computedMaxLength:i,mergedDisabled:p,mergeTextareaAttrs:Ce,getWrapperAttrs:ge,getTextareaAttrs:q,handleInput:ce,handleFocus:ve,handleBlur:fe,handleComposition:me,handleClear:pe,handleResize:we,handleMousedown:be}},methods:{focus(){var e;(e=this.$refs.textareaRef)==null||e.focus()},blur(){var e;(e=this.$refs.textareaRef)==null||e.blur()}}}),Qe=["disabled","value","placeholder"];function Xe(e,t,o,w,g,c){const v=k("resize-observer"),p=k("icon-close"),h=k("icon-hover");return y(),L("div",G(e.getWrapperAttrs(e.$attrs),{class:e.wrapperCls,onMousedown:t[7]||(t[7]=(...n)=>e.handleMousedown&&e.handleMousedown(...n))}),[e.autoSize?(y(),L("div",{key:0,ref:"mirrorRef",class:j(`${e.prefixCls}-mirror`),style:Me(e.mirrorStyle)},D(`${e.computedValue}
`),7)):W("v-if",!0),$(v,{onResize:e.handleResize},{default:_(()=>[ke("textarea",G({ref:"textareaRef"},e.mergeTextareaAttrs,{disabled:e.mergedDisabled,class:e.prefixCls,style:e.textareaStyle,value:e.computedValue,placeholder:e.placeholder,onInput:t[0]||(t[0]=(...n)=>e.handleInput&&e.handleInput(...n)),onFocus:t[1]||(t[1]=(...n)=>e.handleFocus&&e.handleFocus(...n)),onBlur:t[2]||(t[2]=(...n)=>e.handleBlur&&e.handleBlur(...n)),onCompositionstart:t[3]||(t[3]=(...n)=>e.handleComposition&&e.handleComposition(...n)),onCompositionupdate:t[4]||(t[4]=(...n)=>e.handleComposition&&e.handleComposition(...n)),onCompositionend:t[5]||(t[5]=(...n)=>e.handleComposition&&e.handleComposition(...n))}),null,16,Qe)]),_:1},8,["onResize"]),je(e.$slots,"suffix"),e.computedMaxLength&&e.showWordLimit?(y(),L("div",{key:1,class:j(`${e.prefixCls}-word-limit`)},D(e.valueLength)+"/"+D(e.computedMaxLength),3)):W("v-if",!0),e.showClearBtn?(y(),L("div",{key:2,class:j(`${e.prefixCls}-clear-btn`),onClick:t[6]||(t[6]=(...n)=>e.handleClear&&e.handleClear(...n))},[$(h,null,{default:_(()=>[$(p)]),_:1})],2)):W("v-if",!0)],16)}var U=Se(Ke,[["render",Xe]]);const Ye=Object.assign(U,{install:(e,t)=>{Te(e,t);const o=Ee(t);e.component(o+U.name,U)}}),aa=ue({name:"Textarea",__name:"index",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,w=t,g=m({get:()=>o.modelValue,set:c=>{w("update:modelValue",c)}});return(c,v)=>{const p=Ye;return y(),De(He,null,{default:_(()=>[$(p,G({modelValue:g.value,"onUpdate:modelValue":v[0]||(v[0]=h=>g.value=h)},c.$attrs),null,16,["modelValue"])]),_:1})}}});export{aa as default};
