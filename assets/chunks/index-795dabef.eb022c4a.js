import"./index-0f791ed1.e4acd74b.js";import{t as c}from"./index-052d02fc.6e26ec57.js";import{M as v}from"./index.c3a0b7e4.js";import{U as x}from"./index.139b7ef7.js";import{d as B,m as i,o as g,A as y,B as z,G as A,E as S}from"./framework.f10db147.js";import"./index.798c282c.js";import"./use-merge-state.52e1e016.js";import"./render-function.9edc4e68.js";const b=B({name:"Upload",__name:"index",props:{modelValue:{default:()=>""},maxSize:{default:0}},emits:["update:modelValue"],setup(s,{emit:n}){const u=s,a=i({get:()=>u.modelValue,set:e=>{n("update:modelValue",e)}}),o=i(()=>Array.isArray(a.value)?a.value.map(e=>({uid:e,name:e,status:"done",url:e})):[{uid:a.value,name:a.value,status:"done",url:a.value}]);function m(e){return e<1024?e+" B":e<1048576?(e/1024).toFixed(2)+" KB":e<1073741824?(e/1048576).toFixed(2)+" MB":(e/1073741824).toFixed(2)+" GB"}function d(e){return new Promise((l,t)=>{if(u.maxSize&&e.size>u.maxSize*1024){const r=m(u.maxSize*1024);v.error(`文件大小不能超过${r}`),t(!1)}l(!0)})}function p(e){return new Promise(l=>{const t=o.value.findIndex(r=>r.url===e.url);t>-1&&(o.value.splice(t,1),a.value=o.value.map(r=>r.url)),l(!0)})}function f(e){e.url&&(Array.isArray(a.value)?a.value.push(e.url):a.value=e.url)}return(e,l)=>{const t=x;return g(),y(c,null,{default:z(()=>[A(t,S({"list-type":"picture-card","image-preview":!0,"default-file-list":o.value,accept:"image/*","on-before-upload":d,"on-before-remove":p},e.$attrs,{onSuccess:f}),null,16,["default-file-list"])]),_:1})}}});export{b as default};
