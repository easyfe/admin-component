import{N as be,O as we,P as ye,V as Se,W as ze,X as Ve,Y as $e,Z as Be,$ as Le,a0 as $,a1 as Re,a2 as Ie,a3 as te,a4 as xe,a5 as Ne,a6 as Te}from"./index-cb78ba23.fb262486.js";import{J as He}from"./index-1aa7bce8.46e16019.js";import{d as oe,a3 as ke,i as v,l as f,w as O,f as Ae,D as P,o as b,c as B,n as D,H as Ee,t as j,C as W,G as L,B as G,z as Fe,E as J,r as Me,h as le,A as Oe}from"./framework.f715ecba.js";const Pe=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","white-space","overflow-wrap","width"],De=e=>{const t={};return Pe.forEach(m=>{t[m]=e.getPropertyValue(m)}),t},je=oe({name:"Textarea",components:{ResizeObserver:we,IconHover:ye,IconClose:Se},inheritAttrs:!1,props:{modelValue:String,defaultValue:{type:String,default:""},placeholder:String,disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},maxLength:{type:[Number,Object],default:0},showWordLimit:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},autoSize:{type:[Boolean,Object],default:!1},wordLength:{type:Function},wordSlice:{type:Function},textareaAttrs:{type:Object}},emits:{"update:modelValue":e=>!0,input:(e,t)=>!0,change:(e,t)=>!0,clear:e=>!0,focus:e=>!0,blur:e=>!0},setup(e,{emit:t,attrs:m}){const{disabled:w,error:h,modelValue:c}=ke(e),d=ze("textarea"),{mergedDisabled:g,mergedError:p,eventHandlers:o}=Ve({disabled:w,error:h}),u=v(),X=v(),y=v(),Y=v(),R=v(e.defaultValue),i=f(()=>{var a;return(a=c.value)!=null?a:R.value}),[ne,re]=$e(u);O(c,a=>{(Be(a)||Le(a))&&(R.value="")});const S=f(()=>$(e.maxLength)&&!!e.maxLength.errorOnly),s=f(()=>$(e.maxLength)?e.maxLength.length:e.maxLength),z=a=>{var l;return Re(e.wordLength)?e.wordLength(a):(l=a.length)!=null?l:0},Z=f(()=>z(i.value)),q=f(()=>p.value||!!(s.value&&S.value&&Z.value>s.value)),C=v(!1),I=v(!1),ue=f(()=>e.allowClear&&!g.value&&i.value),x=v(!1),K=v(""),N=()=>{ne(),le(()=>{u.value&&i.value!==u.value.value&&(u.value.value=i.value,re())})},V=(a,l=!0)=>{var n,r;s.value&&!S.value&&z(a)>s.value&&(a=(r=(n=e.wordSlice)==null?void 0:n.call(e,a,s.value))!=null?r:a.slice(0,s.value)),R.value=a,l&&t("update:modelValue",a),N()};let T=i.value;const Q=(a,l)=>{var n,r;a!==T&&(T=a,t("change",a,l),(r=(n=o.value)==null?void 0:n.onChange)==null||r.call(n,l))},se=a=>{var l,n;I.value=!0,T=i.value,t("focus",a),(n=(l=o.value)==null?void 0:l.onFocus)==null||n.call(l,a)},ie=a=>{var l,n;I.value=!1,t("blur",a),(n=(l=o.value)==null?void 0:l.onBlur)==null||n.call(l,a),Q(i.value,a)},de=a=>{var l,n;const{value:r}=a.target;if(a.type==="compositionend"){if(x.value=!1,K.value="",s.value&&!S.value&&i.value.length>=s.value&&z(r)>s.value){N();return}t("input",r,a),V(r),(n=(l=o.value)==null?void 0:l.onInput)==null||n.call(l,a)}else x.value=!0},ve=a=>{var l,n;const{value:r}=a.target;if(x.value)K.value=r;else{if(s.value&&!S.value&&i.value.length>=s.value&&z(r)>s.value&&a.inputType==="insertText"){N();return}t("input",r,a),V(r),(n=(l=o.value)==null?void 0:l.onInput)==null||n.call(l,a)}},fe=a=>{V(""),Q("",a),t("clear",a)};O(c,a=>{a!==i.value&&V(a??"",!1)});const me=a=>Ie(m,te),_=a=>xe(m,te),ce=_(),ge=f(()=>{const a={...ce,...e.textareaAttrs};return q.value&&(a["aria-invalid"]=!0),a}),he=f(()=>[`${d}-wrapper`,{[`${d}-focus`]:I.value,[`${d}-disabled`]:g.value,[`${d}-error`]:q.value,[`${d}-scroll`]:C.value}]);let ee;const H=v(0),k=v(0),A=f(()=>!$(e.autoSize)||!e.autoSize.minRows?0:e.autoSize.minRows*H.value+k.value),E=f(()=>!$(e.autoSize)||!e.autoSize.maxRows?0:e.autoSize.maxRows*H.value+k.value),F=()=>{const a=De(ee);H.value=Number.parseInt(a["line-height"]||0,10),k.value=Number.parseInt(a["border-width"]||0,10)*2+Number.parseInt(a["padding-top"]||0,10)+Number.parseInt(a["padding-bottom"]||0,10),Y.value=a,le(()=>{var l;const n=(l=y.value)==null?void 0:l.offsetHeight;let r=n??0,ae="hidden";A.value&&r<A.value&&(r=A.value),E.value&&r>E.value&&(r=E.value,ae="auto"),X.value={height:`${r}px`,resize:"none",overflow:ae}})};Ae(()=>{u.value&&(ee=window.getComputedStyle(u.value),e.autoSize&&F()),M()});const pe=()=>{e.autoSize&&y.value&&F(),M()},Ce=a=>{u.value&&a.target!==u.value&&(a.preventDefault(),u.value.focus())},M=()=>{u.value&&(u.value.scrollHeight>u.value.offsetHeight?C.value||(C.value=!0):C.value&&(C.value=!1))};return O(i,()=>{e.autoSize&&y.value&&F(),M()}),{prefixCls:d,wrapperCls:he,textareaRef:u,textareaStyle:X,mirrorRef:y,mirrorStyle:Y,computedValue:i,showClearBtn:ue,valueLength:Z,computedMaxLength:s,mergedDisabled:g,mergeTextareaAttrs:ge,getWrapperAttrs:me,getTextareaAttrs:_,handleInput:ve,handleFocus:se,handleBlur:ie,handleComposition:de,handleClear:fe,handleResize:pe,handleMousedown:Ce}},methods:{focus(){var e;(e=this.$refs.textareaRef)==null||e.focus()},blur(){var e;(e=this.$refs.textareaRef)==null||e.blur()}}}),We=["disabled","value","placeholder"];function Ue(e,t,m,w,h,c){const d=P("resize-observer"),g=P("icon-close"),p=P("icon-hover");return b(),B("div",J(e.getWrapperAttrs(e.$attrs),{class:e.wrapperCls,onMousedown:t[7]||(t[7]=(...o)=>e.handleMousedown&&e.handleMousedown(...o))}),[e.autoSize?(b(),B("div",{key:0,ref:"mirrorRef",class:D(`${e.prefixCls}-mirror`),style:Ee(e.mirrorStyle)},j(`${e.computedValue}
`),7)):W("v-if",!0),L(d,{onResize:e.handleResize},{default:G(()=>[Fe("textarea",J({ref:"textareaRef"},e.mergeTextareaAttrs,{disabled:e.mergedDisabled,class:e.prefixCls,style:e.textareaStyle,value:e.computedValue,placeholder:e.placeholder,onInput:t[0]||(t[0]=(...o)=>e.handleInput&&e.handleInput(...o)),onFocus:t[1]||(t[1]=(...o)=>e.handleFocus&&e.handleFocus(...o)),onBlur:t[2]||(t[2]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onCompositionstart:t[3]||(t[3]=(...o)=>e.handleComposition&&e.handleComposition(...o)),onCompositionupdate:t[4]||(t[4]=(...o)=>e.handleComposition&&e.handleComposition(...o)),onCompositionend:t[5]||(t[5]=(...o)=>e.handleComposition&&e.handleComposition(...o))}),null,16,We)]),_:1},8,["onResize"]),Me(e.$slots,"suffix"),e.computedMaxLength&&e.showWordLimit?(b(),B("div",{key:1,class:D(`${e.prefixCls}-word-limit`)},j(e.valueLength)+"/"+j(e.computedMaxLength),3)):W("v-if",!0),e.showClearBtn?(b(),B("div",{key:2,class:D(`${e.prefixCls}-clear-btn`),onClick:t[6]||(t[6]=(...o)=>e.handleClear&&e.handleClear(...o))},[L(p,null,{default:G(()=>[L(g)]),_:1})],2)):W("v-if",!0)],16)}var U=be(je,[["render",Ue]]);const Ge=Object.assign(U,{install:(e,t)=>{Ne(e,t);const m=Te(t);e.component(m+U.name,U)}}),Ze=oe({name:"Textarea",__name:"index",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const m=e,w=t,h=f({get:()=>m.modelValue,set:c=>{w("update:modelValue",c)}});return(c,d)=>{const g=Ge;return b(),Oe(He,null,{default:G(()=>[L(g,J({modelValue:h.value,"onUpdate:modelValue":d[0]||(d[0]=p=>h.value=p)},c.$attrs),null,16,["modelValue"])]),_:1})}}});export{Ze as default};
