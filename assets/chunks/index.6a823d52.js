import{d as k,f as B,R as H,y as L,D as c,o as r,c as v,n as h,r as C,A as m,C as y,z as U,G as p,B as A,aa as F,ab as N,a0 as T,ac as _,i as j}from"./framework.26c49a03.js";import{N as z,P,az as V,aA as G,aB as D,aC as R,V as W,ar as Y,W as I,aD as Z,aE as M,aF as q,Z as J,a1 as K,aG as Q,aH as X}from"./index-b15bee20.0964eacc.js";const x=k({name:"Message",components:{AIconHover:P,IconInfoCircleFill:V,IconCheckCircleFill:G,IconExclamationCircleFill:D,IconCloseCircleFill:R,IconClose:W,IconLoading:Y},props:{type:{type:String,default:"info"},closable:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!0},duration:{type:Number,default:3e3},resetOnUpdate:{type:Boolean,default:!1},resetOnHover:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:o}){const n=I("message");let i=0;const l=()=>{o("close")},s=()=>{e.duration>0&&(i=window.setTimeout(l,e.duration))},t=()=>{i&&(window.clearTimeout(i),i=0)};return B(()=>{s()}),H(()=>{e.resetOnUpdate&&(t(),s())}),L(()=>{t()}),{handleMouseEnter:()=>{e.resetOnHover&&t()},handleMouseLeave:()=>{e.resetOnHover&&s()},prefixCls:n,handleClose:l}}});function ee(e,o,n,i,l,s){const t=c("icon-info-circle-fill"),a=c("icon-check-circle-fill"),u=c("icon-exclamation-circle-fill"),O=c("icon-close-circle-fill"),E=c("icon-loading"),S=c("icon-close"),w=c("a-icon-hover");return r(),v("li",{role:"alert",class:h([e.prefixCls,`${e.prefixCls}-${e.type}`,{[`${e.prefixCls}-closable`]:e.closable}]),onMouseenter:o[1]||(o[1]=(...f)=>e.handleMouseEnter&&e.handleMouseEnter(...f)),onMouseleave:o[2]||(o[2]=(...f)=>e.handleMouseLeave&&e.handleMouseLeave(...f))},[e.showIcon&&!(e.type==="normal"&&!e.$slots.icon)?(r(),v("span",{key:0,class:h(`${e.prefixCls}-icon`)},[C(e.$slots,"icon",{},()=>[e.type==="info"?(r(),m(t,{key:0})):e.type==="success"?(r(),m(a,{key:1})):e.type==="warning"?(r(),m(u,{key:2})):e.type==="error"?(r(),m(O,{key:3})):e.type==="loading"?(r(),m(E,{key:4})):y("v-if",!0)])],2)):y("v-if",!0),U("span",{class:h(`${e.prefixCls}-content`)},[C(e.$slots,"default")],2),e.closable?(r(),v("span",{key:1,class:h(`${e.prefixCls}-close-btn`),onClick:o[0]||(o[0]=(...f)=>e.handleClose&&e.handleClose(...f))},[p(w,null,{default:A(()=>[p(S)]),_:1})],2)):y("v-if",!0)],34)}var se=z(x,[["render",ee]]);function oe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!N(e)}var ne=k({name:"MessageList",props:{messages:{type:Array,default:()=>[]},position:{type:String,default:"top"}},emits:["close","afterClose"],setup(e,o){const n=I("message-list"),{zIndex:i}=Z("message",{runOnMounted:!0});return()=>{let l;return p(F,{class:[n,`${n}-${e.position}`],name:"fade-message",tag:"ul",style:{zIndex:i.value},onAfterLeave:()=>o.emit("afterClose")},oe(l=e.messages.map(s=>{const t={default:M(s.content),icon:M(s.icon)};return p(se,{key:s.id,type:s.type,duration:s.duration,closable:s.closable,resetOnUpdate:s.resetOnUpdate,resetOnHover:s.resetOnHover,onClose:()=>o.emit("close",s.id)},t)}))?l:{default:()=>[l]})}}});class te{constructor(o,n){this.messageCount=0,this.add=s=>{var t;this.messageCount++;const a=(t=s.id)!=null?t:`__arco_message_${this.messageCount}`;if(this.messageIds.has(a))return this.update(a,s);const u=T({id:a,...s});return this.messages.value.push(u),this.messageIds.add(a),{close:()=>this.remove(a)}},this.update=(s,t)=>{for(let a=0;a<this.messages.value.length;a++)if(this.messages.value[a].id===s){const u=!J(t.duration);Object.assign(this.messages.value[a],{...t,id:s,resetOnUpdate:u});break}return{close:()=>this.remove(s)}},this.remove=s=>{for(let t=0;t<this.messages.value.length;t++){const a=this.messages.value[t];if(a.id===s){K(a.onClose)&&a.onClose(s),this.messages.value.splice(t,1),this.messageIds.delete(s);break}}},this.clear=()=>{this.messages.value.splice(0)},this.destroy=()=>{this.messages.value.length===0&&this.container&&(_(null,this.container),document.body.removeChild(this.container),this.container=null,d[this.position]=void 0)};const{position:i="top"}=o;this.container=Q("message"),this.messageIds=new Set,this.messages=j([]),this.position=i;const l=p(ne,{messages:this.messages.value,position:i,onClose:this.remove,onAfterClose:this.destroy});(n??b._context)&&(l.appContext=n??b._context),_(l,this.container),document.body.appendChild(this.container)}}const d={},$=[...X,"loading","normal"],g=$.reduce((e,o)=>(e[o]=(n,i)=>{q(n)&&(n={content:n});const l={type:o,...n},{position:s="top"}=l;return d[s]||(d[s]=new te(l,i)),d[s].add(l)},e),{});g.clear=e=>{var o;e?(o=d[e])==null||o.clear():Object.values(d).forEach(n=>n==null?void 0:n.clear())};const b={...g,install:e=>{const o={clear:g.clear};for(const n of $)o[n]=(i,l=e._context)=>g[n](i,l);e.config.globalProperties.$message=o},_context:null};export{b as M};
