import{ap as qt,_ as Ee,L as De,ai as Wt,K as ot,aR as be,aS as Yt,I as Gt,aa as Qt,Q as ce,V as $e,aH as Zt,ah as Te,ay as Jt,aT as Xt,aL as en,ad as Kt,ae as wt,aU as tn,aK as nn,a9 as Ge,aP as an,ao as ln,aO as on,aM as rn,aN as sn,a6 as un,aq as dn}from"./index-26f37704.e07d1ef6.js";import{t as cn}from"./index-62e77c68.773a85e7.js";import{a as ze}from"./use-merge-state.b7ff3acf.js";import{R as $t,d as oe,m,o as $,c as q,n as R,H as Et,z as we,a7 as ne,af as Ke,j as O,U as pn,f as vn,a3 as ee,D as Z,C as I,F as Ve,L as Qe,G as te,a8 as Dt,B as le,r as U,A as _,ag as Re,E as F,a as fn,t as yn,T as hn,l as Be,S as gn,a2 as bn,w as rt,I as mn,ax as kn,i as Sn}from"./framework.f5b7da40.js";import{R as Pt}from"./render-function.82f4a3f3.js";const Ot=Symbol("TreeInjectionKey");function Cn(e){const t=[];function n(a){a&&a.forEach(l=>{t.push(l),n(l.children)})}return n(e),t}function Nn(e){const t=new Map;return e.forEach(n=>{t.set(n.key,n)}),t}function He(e){return e.selectable&&!e.disabled}function st(e){return!e.isLeaf&&e.children}function Kn(e){return qt(e.isLeaf)?e.isLeaf:!e.children}function xe(e){return Set.prototype.add.bind(e)}function Ue(e){return Set.prototype.delete.bind(e)}function Se(e){return e.disabled||e.disableCheckbox?!1:!!e.checkable}function Ze(e){var t;const n=[];return(t=e.children)==null||t.forEach(a=>{Se(a)&&n.push(a.key,...Ze(a))}),n}function Tt(e){var t;const{node:n,checkedKeySet:a,indeterminateKeySet:l}=e;let s=n.parent;for(;s;){if(Se(s)){const o=s.key,c=((t=s.children)==null?void 0:t.filter(Se))||[];let r=0;const u=c.length;c.some(({key:d})=>{if(a.has(d))r+=1;else if(l.has(d))return r+=.5,!0;return!1}),r&&r!==u?l.add(o):l.delete(o),r&&r===u?a.add(o):a.delete(o)}s=s.parent}}function qe(e){const{node:t,checked:n,checkedKeys:a,indeterminateKeys:l,checkStrictly:s=!1}=e,{key:o}=t,c=new Set(a),r=new Set(l);if(n?c.add(o):c.delete(o),r.delete(o),!s){const u=Ze(t);n?u.forEach(xe(c)):u.forEach(Ue(c)),u.forEach(Ue(r)),Tt({node:t,checkedKeySet:c,indeterminateKeySet:r})}return[[...c],[...r]]}function wn(e){const{initCheckedKeys:t,key2TreeNode:n,checkStrictly:a,onlyCheckLeaf:l}=e,s=new Set,o=new Set,c=new Set;return a?t.forEach(xe(s)):t.forEach(r=>{var u;const d=n.get(r);if(!d||o.has(r)||l&&((u=d.children)!=null&&u.length))return;const h=Ze(d);h.forEach(xe(o)),h.forEach(Ue(c)),s.add(r),c.delete(r),Tt({node:d,checkedKeySet:s,indeterminateKeySet:c})}),[[...s,...o],[...c]]}function Ie(){return $t(Ot)||{}}const $n=oe({name:"IconFile",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:t}){const n=De("icon"),a=m(()=>[n,`${n}-file`,{[`${n}-spin`]:e.spin}]),l=m(()=>{const o={};return e.size&&(o.fontSize=Wt(e.size)?`${e.size}px`:e.size),e.rotate&&(o.transform=`rotate(${e.rotate}deg)`),o});return{cls:a,innerStyle:l,onClick:o=>{t("click",o)}}}}),En=["stroke-width","stroke-linecap","stroke-linejoin"],Dn=we("path",{d:"M16 21h16m-16 8h10m11 13H11a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h21l7 7v27a2 2 0 0 1-2 2Z"},null,-1),Pn=[Dn];function On(e,t,n,a,l,s){return $(),q("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:R(e.cls),style:Et(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:t[0]||(t[0]=(...o)=>e.onClick&&e.onClick(...o))},Pn,14,En)}var je=Ee($n,[["render",On]]);const Tn=Object.assign(je,{install:(e,t)=>{var n;const a=(n=t==null?void 0:t.iconPrefix)!=null?n:"";e.component(a+je.name,je)}});var Vn=oe({name:"TreeNodeSwitcher",components:{IconLoading:ot,RenderFunction:Pt},props:{prefixCls:String,loading:Boolean,showLine:Boolean,treeNodeData:{type:Object},icons:{type:Object},nodeStatus:{type:Object}},emits:["click"],setup(e,{slots:t,emit:n}){const{icons:a,nodeStatus:l,treeNodeData:s}=ne(e),o=Ie(),c=be(t,"switcher-icon"),r=be(t,"loading-icon");return{getSwitcherIcon:()=>{var u,d,h;const k=(d=(u=a==null?void 0:a.value)==null?void 0:u.switcherIcon)!=null?d:c.value;return k?k(l.value):(h=o.switcherIcon)==null?void 0:h.call(o,s.value,l.value)},getLoadingIcon:()=>{var u,d,h;const k=(d=(u=a==null?void 0:a.value)==null?void 0:u.loadingIcon)!=null?d:r.value;return k?k(l.value):(h=o.loadingIcon)==null?void 0:h.call(o,s.value,l.value)},onClick(u){n("click",u)}}},render(){var e,t,n;const{prefixCls:a,getSwitcherIcon:l,getLoadingIcon:s,onClick:o,nodeStatus:c={},loading:r,showLine:u}=this,{expanded:d,isLeaf:h}=c;if(r)return(e=s())!=null?e:Ke(ot);let k=null,C=!1;if(h)u&&(k=(n=l())!=null?n:Ke(Tn));else{const D=u?Ke("span",{class:`${a}-${d?"minus":"plus"}-icon`}):Ke(Yt);k=(t=l())!=null?t:D,C=!u}if(!k)return null;const g=Ke("span",{class:`${a}-switcher-icon`,onClick:o},k);return C?Ke(Gt,{class:`${a}-icon-hover`},()=>g):g}}),Bn=Object.defineProperty,In=Object.defineProperties,Ln=Object.getOwnPropertyDescriptors,it=Object.getOwnPropertySymbols,_n=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable,ut=(e,t,n)=>t in e?Bn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,We=(e,t)=>{for(var n in t||(t={}))_n.call(t,n)&&ut(e,n,t[n]);if(it)for(var n of it(t))Fn.call(t,n)&&ut(e,n,t[n]);return e},dt=(e,t)=>In(e,Ln(t));const Vt=(()=>{let e=0;return()=>(e+=1,`__arco_tree${e}`)})();function jn(e,t){return!!(ce(e)?t:e)}function An(e,t){const n=We({},e);return t&&Object.keys(t).forEach(l=>{const s=t[l];s!==l&&(n[l]=e[s],delete n[s])}),n}function ct({subEnable:e,superEnable:t,isLeaf:n,treeNodeData:a,level:l}){return ce(e)?$e(t)?t(a,{isLeaf:n,level:l}):t??!1:e}function Mn(e){var t,n;const{treeNodeData:a,parentNode:l,isTail:s=!0,treeProps:o}=e,{fieldNames:c}=o||{},r=An(a,c),u=o.loadMore?!!r.isLeaf:!((t=r.children)!=null&&t.length),d=l?l.level+1:0,h=dt(We({},Qt(r,["children"])),{key:(n=r.key)!=null?n:Vt(),selectable:ct({subEnable:r.selectable,superEnable:o==null?void 0:o.selectable,isLeaf:u,level:d,treeNodeData:a}),disabled:!!r.disabled,disableCheckbox:!!r.disableCheckbox,checkable:ct({subEnable:r.checkable,superEnable:o==null?void 0:o.checkable,isLeaf:u,level:d,treeNodeData:a}),isLeaf:u,isTail:s,blockNode:!!(o!=null&&o.blockNode),showLine:!!(o!=null&&o.showLine),level:d,lineless:l?[...l.lineless,l.isTail]:[],draggable:jn(r.draggable,o==null?void 0:o.draggable)});return dt(We({},h),{treeNodeProps:h,treeNodeData:a,parent:l,parentKey:l==null?void 0:l.key,pathParentKeys:l?[...l.pathParentKeys,l.key]:[]})}function zn(e,t){function n(a,l){if(!a)return;const{fieldNames:s}=t,o=[];return a.forEach((c,r)=>{const u=Mn({treeNodeData:c,treeProps:t,parentNode:l,isTail:r===a.length-1});u.children=n(c[(s==null?void 0:s.children)||"children"],u),o.push(u)}),o}return n(e)}function Bt(){const e=vn(),t=()=>{var a;return(a=e==null?void 0:e.vnode.key)!=null?a:Vt()},n=O(t());return pn(()=>{n.value=t()}),n}function Rn(e){const{key:t,refTitle:n}=ne(e),a=Ie(),l=O(!1),s=O(!1),o=O(!1),c=O(0),r=Zt(u=>{if(!n.value)return;const d=n.value.getBoundingClientRect(),h=window.pageYOffset+d.top,{pageY:k}=u,C=d.height/4,g=k-h;c.value=g<C?-1:g<d.height-C?0:1,o.value=a.allowDrop?a.allowDrop(t.value,c.value):!0});return{isDragOver:l,isDragging:s,isAllowDrop:o,dropPosition:c,setDragStatus(u,d){switch(u){case"dragStart":s.value=!0,c.value=0,a.onDragStart&&a.onDragStart(t.value,d);break;case"dragEnd":s.value=!1,l.value=!1,c.value=0,r.cancel(),a.onDragEnd&&a.onDragEnd(t.value,d);break;case"dragOver":l.value=!0,r(d),a.onDragOver&&a.onDragOver(t.value,d);break;case"dragLeave":l.value=!1,c.value=0,r.cancel(),a.onDragLeave&&a.onDragLeave(t.value,d);break;case"drop":a.onDrop&&a.onDrop(t.value,c.value,d),l.value=!1,c.value=0,r.cancel();break}}}}function Hn(e){return Te(e)?e:[e]}const xn=oe({name:"BaseTreeNode",components:{NodeSwitcher:Vn,Checkbox:Jt,RenderFunction:Pt,IconDragDotVertical:Xt},props:{key:{type:[String,Number]},title:{type:String},selectable:{type:Boolean},disabled:{type:Boolean},disableCheckbox:{type:Boolean},checkable:{type:Boolean},draggable:{type:Boolean},isLeaf:{type:Boolean},icon:{type:Function},switcherIcon:{type:Function},loadingIcon:{type:Function},dragIcon:{type:Function},isTail:{type:Boolean},blockNode:{type:Boolean},showLine:{type:Boolean},level:{type:Number,default:0},lineless:{type:Array,default:()=>[]}},setup(e){const t=Bt(),n=De("tree-node"),a=Ie(),l=m(()=>{var p;return(p=a.key2TreeNode)==null?void 0:p.get(t.value)}),s=m(()=>l.value.treeNodeData),o=m(()=>l.value.children),c=m(()=>{var p;const S=(p=a.treeProps)==null?void 0:p.actionOnNodeClick;return S?Hn(S):[]}),{isLeaf:r,isTail:u,selectable:d,disabled:h,disableCheckbox:k,draggable:C}=ne(e),g=m(()=>{var p;return[`${n}`,{[`${n}-selected`]:H.value,[`${n}-is-leaf`]:r.value,[`${n}-is-tail`]:u.value,[`${n}-expanded`]:L.value,[`${n}-disabled-selectable`]:!d.value&&!((p=a.treeProps)!=null&&p.disableSelectActionOnly),[`${n}-disabled`]:h.value}]}),D=O(),{isDragOver:E,isDragging:T,isAllowDrop:j,dropPosition:W,setDragStatus:K}=Rn(ee({key:t,refTitle:D})),V=m(()=>[`${n}-title`,{[`${n}-title-draggable`]:C.value,[`${n}-title-gap-top`]:E.value&&j.value&&W.value<0,[`${n}-title-gap-bottom`]:E.value&&j.value&&W.value>0,[`${n}-title-highlight`]:!T.value&&E.value&&j.value&&W.value===0,[`${n}-title-dragging`]:T.value,[`${n}-title-block`]:l.value.blockNode}]),A=m(()=>{var p,S;return(S=(p=a.checkedKeys)==null?void 0:p.includes)==null?void 0:S.call(p,t.value)}),Y=m(()=>{var p,S;return(S=(p=a.indeterminateKeys)==null?void 0:p.includes)==null?void 0:S.call(p,t.value)}),H=m(()=>{var p,S;return(S=(p=a.selectedKeys)==null?void 0:p.includes)==null?void 0:S.call(p,t.value)}),L=m(()=>{var p,S;return(S=(p=a.expandedKeys)==null?void 0:p.includes)==null?void 0:S.call(p,t.value)}),re=m(()=>{var p,S;return(S=(p=a.loadingKeys)==null?void 0:p.includes)==null?void 0:S.call(p,t.value)}),se=m(()=>a.dragIcon),pe=m(()=>a.nodeIcon);function G(p){var S,z;r.value||(!((S=o.value)!=null&&S.length)&&$e(a.onLoadMore)?a.onLoadMore(t.value):(z=a==null?void 0:a.onExpand)==null||z.call(a,!L.value,t.value,p))}const M=ee({loading:re,checked:A,selected:H,indeterminate:Y,expanded:L,isLeaf:r}),Q=m(()=>a.nodeTitle?()=>{var p;return(p=a.nodeTitle)==null?void 0:p.call(a,s.value,M)}:void 0),ie=m(()=>a.nodeExtra?()=>{var p;return(p=a.nodeExtra)==null?void 0:p.call(a,s.value,M)}:void 0);return{nodekey:t,refTitle:D,prefixCls:n,classNames:g,titleClassNames:V,indeterminate:Y,checked:A,expanded:L,selected:H,treeTitle:Q,treeNodeData:s,loading:re,treeDragIcon:se,treeNodeIcon:pe,extra:ie,nodeStatus:M,onCheckboxChange(p,S){var z;k.value||h.value||(z=a.onCheck)==null||z.call(a,p,t.value,S)},onTitleClick(p){var S;c.value.includes("expand")&&G(p),!(!d.value||h.value)&&((S=a.onSelect)==null||S.call(a,t.value,p))},onSwitcherClick:G,onDragStart(p){var S;if(C.value){p.stopPropagation(),K("dragStart",p);try{(S=p.dataTransfer)==null||S.setData("text/plain","")}catch{}}},onDragEnd(p){C.value&&(p.stopPropagation(),K("dragEnd",p))},onDragOver(p){C&&(p.stopPropagation(),p.preventDefault(),K("dragOver",p))},onDragLeave(p){C.value&&(p.stopPropagation(),K("dragLeave",p))},onDrop(p){!C.value||!j.value||(p.stopPropagation(),p.preventDefault(),K("drop",p))}}}}),Un=["data-level","data-key"],qn=["draggable"];function Wn(e,t,n,a,l,s){const o=Z("NodeSwitcher"),c=Z("Checkbox"),r=Z("RenderFunction"),u=Z("IconDragDotVertical");return $(),q("div",{class:R(e.classNames),"data-level":e.level,"data-key":e.nodekey},[I(" 缩进 "),we("span",{class:R(`${e.prefixCls}-indent`)},[($(!0),q(Ve,null,Qe(e.level,d=>($(),q("span",{key:d,class:R([`${e.prefixCls}-indent-block`,{[`${e.prefixCls}-indent-block-lineless`]:e.lineless[d-1]}])},null,2))),128))],2),I(" switcher "),we("span",{class:R([`${e.prefixCls}-switcher`,{[`${e.prefixCls}-switcher-expanded`]:e.expanded}])},[te(o,{"prefix-cls":e.prefixCls,loading:e.loading,"show-line":e.showLine,"tree-node-data":e.treeNodeData,icons:{switcherIcon:e.switcherIcon,loadingIcon:e.loadingIcon},"node-status":e.nodeStatus,onClick:e.onSwitcherClick},Dt({_:2},[e.$slots["switcher-icon"]?{name:"switcher-icon",fn:le(()=>[I(" @slot 定制 switcher 图标，会覆盖 Tree 的配置 "),U(e.$slots,"switcher-icon")])}:void 0,e.$slots["loading-icon"]?{name:"loading-icon",fn:le(()=>[I(" @slot 定制 loading 图标，会覆盖 Tree 的配置 "),U(e.$slots,"loading-icon")])}:void 0]),1032,["prefix-cls","loading","show-line","tree-node-data","icons","node-status","onClick"])],2),I(" checkbox "),e.checkable?($(),_(c,{key:0,disabled:e.disableCheckbox||e.disabled,"model-value":e.checked,indeterminate:e.indeterminate,"uninject-group-context":"",onChange:e.onCheckboxChange},null,8,["disabled","model-value","indeterminate","onChange"])):I("v-if",!0),I(" 内容 "),we("span",{ref:"refTitle",class:R(e.titleClassNames),draggable:e.draggable,onDragstart:t[0]||(t[0]=(...d)=>e.onDragStart&&e.onDragStart(...d)),onDragend:t[1]||(t[1]=(...d)=>e.onDragEnd&&e.onDragEnd(...d)),onDragover:t[2]||(t[2]=(...d)=>e.onDragOver&&e.onDragOver(...d)),onDragleave:t[3]||(t[3]=(...d)=>e.onDragLeave&&e.onDragLeave(...d)),onDrop:t[4]||(t[4]=(...d)=>e.onDrop&&e.onDrop(...d)),onClick:t[5]||(t[5]=(...d)=>e.onTitleClick&&e.onTitleClick(...d))},[e.$slots.icon||e.icon||e.treeNodeIcon?($(),q("span",{key:0,class:R([`${e.prefixCls}-icon`,`${e.prefixCls}-custom-icon`])},[I(" 节点图标 "),e.$slots.icon?U(e.$slots,"icon",Re(F({key:0},e.nodeStatus))):e.icon?($(),_(r,F({key:1,"render-func":e.icon},e.nodeStatus),null,16,["render-func"])):e.treeNodeIcon?($(),_(r,F({key:2,"render-func":e.treeNodeIcon,node:e.treeNodeData},e.nodeStatus),null,16,["render-func","node"])):I("v-if",!0)],2)):I("v-if",!0),we("span",{class:R(`${e.prefixCls}-title-text`)},[e.treeTitle?($(),_(r,{key:0,"render-func":e.treeTitle},null,8,["render-func"])):($(),q(Ve,{key:1},[I(" 标题，treeTitle 优先级高于节点的 title "),U(e.$slots,"title",{},()=>[fn(yn(e.title),1)])],2112)),e.draggable?($(),q("span",{key:2,class:R([`${e.prefixCls}-icon`,`${e.prefixCls}-drag-icon`])},[I(" 拖拽图标 "),e.$slots["drag-icon"]?U(e.$slots,"drag-icon",Re(F({key:0},e.nodeStatus))):e.dragIcon?($(),_(r,F({key:1,"render-func":e.dragIcon},e.nodeStatus),null,16,["render-func"])):e.treeDragIcon?($(),_(r,F({key:2,"render-func":e.treeDragIcon,node:e.treeNodeData},e.nodeStatus),null,16,["render-func","node"])):($(),_(u,{key:3}))],2)):I("v-if",!0)],2)],42,qn),I(" 额外 "),e.extra?($(),_(r,{key:1,"render-func":e.extra},null,8,["render-func"])):I("v-if",!0)],10,Un)}var Ye=Ee(xn,[["render",Wn]]);const Yn=oe({name:"ExpandTransition",props:{expanded:Boolean},emits:["end"],setup(e,{emit:t}){return{onBeforeEnter(n){n.style.height=e.expanded?"0":`${n.scrollHeight}px`},onEnter(n){n.style.height=e.expanded?`${n.scrollHeight}px`:"0"},onAfterEnter(n){n.style.height=e.expanded?"":"0",t("end")},onBeforeLeave(n){n.style.display="none"}}}});function Gn(e,t,n,a,l,s){return $(),_(hn,{onBeforeEnter:e.onBeforeEnter,onEnter:e.onEnter,onAfterEnter:e.onAfterEnter,onBeforeLeave:e.onBeforeLeave},{default:le(()=>[U(e.$slots,"default")]),_:3},8,["onBeforeEnter","onEnter","onAfterEnter","onBeforeLeave"])}var Qn=Ee(Yn,[["render",Gn]]);const Zn=oe({name:"TransitionNodeList",components:{ExpandTransition:Qn,BaseTreeNode:Ye},props:{nodeKey:{type:[String,Number],required:!0}},setup(e){const n=[`${De("tree")}-node-list`],a=Ie(),{nodeKey:l}=ne(e),s=m(()=>{var r,u;return(u=(r=a.expandedKeys)==null?void 0:r.includes)==null?void 0:u.call(r,l.value)}),o=m(()=>{var r;const u=new Set(a.expandedKeys||[]),d=(r=a.flattenTreeData)==null?void 0:r.filter(h=>{var k,C;return(k=h.pathParentKeys)!=null&&k.includes(l.value)?!a.filterTreeNode||((C=a.filterTreeNode)==null?void 0:C.call(a,h.treeNodeData)):!1});return d==null?void 0:d.filter(h=>{var k;if(s.value)return(k=h.pathParentKeys)==null?void 0:k.every(g=>u.has(g));const C=h.pathParentKeys.indexOf(l.value);return h.pathParentKeys.slice(C+1).every(g=>u.has(g))})}),c=m(()=>{var r,u;return((r=a.currentExpandKeys)==null?void 0:r.includes(l.value))&&((u=o.value)==null?void 0:u.length)});return{classNames:n,visibleNodeList:o,show:c,expanded:s,onTransitionEnd(){var r;(r=a.onExpandEnd)==null||r.call(a,l.value)}}}});function Jn(e,t,n,a,l,s){const o=Z("BaseTreeNode"),c=Z("ExpandTransition");return $(),_(c,{expanded:e.expanded,onEnd:e.onTransitionEnd},{default:le(()=>[e.show?($(),q("div",{key:0,class:R(e.classNames)},[($(!0),q(Ve,null,Qe(e.visibleNodeList,r=>($(),_(o,F({key:r.key},r.treeNodeProps),null,16))),128))],2)):I("v-if",!0)]),_:1},8,["expanded","onEnd"])}var Xn=Ee(Zn,[["render",Jn]]),ea=Object.defineProperty,pt=Object.getOwnPropertySymbols,ta=Object.prototype.hasOwnProperty,na=Object.prototype.propertyIsEnumerable,vt=(e,t,n)=>t in e?ea(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,aa=(e,t)=>{for(var n in t||(t={}))ta.call(t,n)&&vt(e,n,t[n]);if(pt)for(var n of pt(t))na.call(t,n)&&vt(e,n,t[n]);return e},la=oe({name:"TreeNode",inheritAttrs:!1,props:aa({},Ye.props),setup(e,{slots:t,attrs:n}){const a=Bt();return()=>te(Ve,null,[te(Ye,F(e,n,{key:a.value}),t),te(Xn,{key:a.value,nodeKey:a.value},null)])}});function oa(e){const{defaultCheckedKeys:t,checkedKeys:n,key2TreeNode:a,checkStrictly:l,halfCheckedKeys:s,onlyCheckLeaf:o}=ne(e),c=O(!1),r=O([]),u=O([]),d=O(),h=O(),k=g=>wn({initCheckedKeys:g,key2TreeNode:a.value,checkStrictly:l.value,onlyCheckLeaf:o.value}),C=g=>{const D=k(g);[r.value,u.value]=D};return C(n.value||(t==null?void 0:t.value)||[]),Be(()=>{n.value?[d.value,h.value]=k(n.value):c.value&&(d.value=void 0,h.value=void 0,r.value=[],u.value=[]),c.value||(c.value=!0)}),{checkedKeys:m(()=>d.value||r.value),indeterminateKeys:m(()=>l.value&&s.value?s.value:h.value||u.value),setCheckedState(g,D,E=!1){return E?C(g):(r.value=g,u.value=D),[r.value,u.value]}}}function It(e){const{treeData:t,fieldNames:n,selectable:a,showLine:l,blockNode:s,checkable:o,loadMore:c,draggable:r}=ne(e),u=O([]);Be(()=>{var k,C;u.value=zn(t.value||[],{selectable:(k=a==null?void 0:a.value)!=null?k:!1,showLine:!!(l!=null&&l.value),blockNode:!!(s!=null&&s.value),checkable:(C=o==null?void 0:o.value)!=null?C:!1,fieldNames:n==null?void 0:n.value,loadMore:!!(c!=null&&c.value),draggable:!!(r!=null&&r.value)})});const d=m(()=>Cn(u.value)),h=m(()=>Nn(d.value));return{treeData:u,flattenTreeData:d,key2TreeNode:h}}const ra=oe({name:"Tree",components:{VirtualList:en,TreeNode:la},props:{size:{type:String,default:"medium"},blockNode:{type:Boolean},defaultExpandAll:{type:Boolean,default:!0},multiple:{type:Boolean},checkable:{type:[Boolean,String,Function],default:!1},selectable:{type:[Boolean,Function],default:!0},checkStrictly:{type:Boolean},checkedStrategy:{type:String,default:"all"},defaultSelectedKeys:{type:Array},selectedKeys:{type:Array},defaultCheckedKeys:{type:Array},checkedKeys:{type:Array},defaultExpandedKeys:{type:Array},expandedKeys:{type:Array},data:{type:Array,default:()=>[]},fieldNames:{type:Object},showLine:{type:Boolean},loadMore:{type:Function},draggable:{type:Boolean},allowDrop:{type:Function},filterTreeNode:{type:Function},searchValue:{type:String,default:""},virtualListProps:{type:Object},defaultExpandSelected:{type:Boolean},defaultExpandChecked:{type:Boolean},autoExpandParent:{type:Boolean,default:!0},halfCheckedKeys:{type:Array},onlyCheckLeaf:{type:Boolean,default:!1},animation:{type:Boolean,default:!0},actionOnNodeClick:{type:String},disableSelectActionOnly:{type:Boolean,default:!1}},emits:{select:(e,t)=>!0,"update:selectedKeys":e=>!0,check:(e,t)=>!0,"update:checkedKeys":e=>!0,"update:halfCheckedKeys":e=>!0,expand:(e,t)=>!0,"update:expandedKeys":e=>!0,dragStart:(e,t)=>!0,dragEnd:(e,t)=>!0,dragOver:(e,t)=>!0,dragLeave:(e,t)=>!0,drop:e=>!0},setup(e,{emit:t,slots:n}){const{data:a,showLine:l,multiple:s,loadMore:o,checkStrictly:c,checkedKeys:r,defaultCheckedKeys:u,selectedKeys:d,defaultSelectedKeys:h,expandedKeys:k,defaultExpandedKeys:C,checkedStrategy:g,selectable:D,checkable:E,blockNode:T,fieldNames:j,size:W,defaultExpandAll:K,filterTreeNode:V,draggable:A,allowDrop:Y,defaultExpandSelected:H,defaultExpandChecked:L,autoExpandParent:re,halfCheckedKeys:se,onlyCheckLeaf:pe,animation:G}=ne(e),M=De("tree"),Q=m(()=>[`${M}`,{[`${M}-checkable`]:E.value,[`${M}-show-line`]:l.value},`${M}-size-${W.value}`]),ie=be(n,"switcher-icon"),p=be(n,"loading-icon"),S=be(n,"drag-icon"),z=be(n,"icon"),ae=be(n,"title"),Le=be(n,"extra"),{treeData:_e,flattenTreeData:Pe,key2TreeNode:P}=It(ee({treeData:a,selectable:D,showLine:l,blockNode:T,checkable:E,fieldNames:j,loadMore:o,draggable:A})),{checkedKeys:ve,indeterminateKeys:ue,setCheckedState:J}=oa(ee({defaultCheckedKeys:u,checkedKeys:r,checkStrictly:c,key2TreeNode:P,halfCheckedKeys:se,onlyCheckLeaf:pe})),[fe,Oe]=ze((h==null?void 0:h.value)||[],ee({value:d})),X=O([]),ye=O();function Fe(){if(C!=null&&C.value){const i=new Set([]);return C.value.forEach(v=>{if(i.has(v))return;const f=P.value.get(v);f&&[...re.value?f.pathParentKeys:[],v].forEach(y=>i.add(y))}),[...i]}if(K.value)return Pe.value.filter(i=>i.children&&i.children.length).map(i=>i.key);if(H.value||L.value){const i=new Set([]),v=f=>{f.forEach(y=>{const b=P.value.get(y);b&&(b.pathParentKeys||[]).forEach(N=>i.add(N))})};return H.value&&v(fe.value),L.value&&v(ve.value),[...i]}return[]}const[me,he]=ze(Fe(),ee({value:k})),de=O([]),et=m(()=>{const i=new Set(me.value),v=new Set(de.value);return Pe.value.filter(f=>{var y;if(!(!V||!V.value||(V==null?void 0:V.value(f.treeNodeData))))return!1;const N=ce(f.parentKey),ke=(y=f.pathParentKeys)==null?void 0:y.every(Ne=>i.has(Ne)&&!v.has(Ne));return N||ke})});function w(i,v=g.value){let f=[...i];return v==="parent"?f=i.filter(y=>{const b=P.value.get(y);return b&&!(!ce(b.parentKey)&&i.includes(b.parentKey))}):v==="child"&&(f=i.filter(y=>{var b,N;return!((N=(b=P.value.get(y))==null?void 0:b.children)!=null&&N.length)})),f}function B(i){return i.map(v=>{var f;return((f=P.value.get(v))==null?void 0:f.treeNodeData)||void 0}).filter(Boolean)}function x(i){const{targetKey:v,targetChecked:f,newCheckedKeys:y,newIndeterminateKeys:b,event:N}=i,ke=v?P.value.get(v):void 0,Ne=w(y);t("update:checkedKeys",Ne),t("update:halfCheckedKeys",b),t("check",Ne,{checked:f,node:ke==null?void 0:ke.treeNodeData,checkedNodes:B(Ne),halfCheckedKeys:b,halfCheckedNodes:B(b),e:N})}function ge(i){const{targetKey:v,targetSelected:f,newSelectedKeys:y,event:b}=i,N=v?P.value.get(v):void 0;t("update:selectedKeys",y),t("select",y,{selected:f,node:N==null?void 0:N.treeNodeData,selectedNodes:B(y),e:b})}function Ce(i){const{targetKey:v,targetExpanded:f,newExpandedKeys:y,event:b}=i,N=v?P.value.get(v):void 0;t("expand",y,{expanded:f,node:N==null?void 0:N.treeNodeData,expandedNodes:B(y),e:b}),t("update:expandedKeys",y)}function jt(i){const[v,f]=J(i,[],!0);x({newCheckedKeys:v,newIndeterminateKeys:f})}function At(i){let v=i;!s.value&&i.length>1&&(v=[i[0]]),Oe(v),ge({newSelectedKeys:v})}function Mt(i){de.value=[],he(i),Ce({newExpandedKeys:i})}function zt(i,v,f){if(!i.length)return;let y=[...ve.value],b=[...ue.value];i.forEach(N=>{const ke=P.value.get(N);ke&&([y,b]=qe({node:ke,checked:v,checkedKeys:[...y],indeterminateKeys:[...b],checkStrictly:c.value}))}),J(y,b),x({targetKey:f,targetChecked:ce(f)?void 0:v,newCheckedKeys:y,newIndeterminateKeys:b})}function Rt(i,v,f){if(!i.length)return;let y;if(s.value){const b=new Set(fe.value);i.forEach(N=>{v?b.add(N):b.delete(N)}),y=[...b]}else y=v?[i[0]]:[];Oe(y),ge({targetKey:f,targetSelected:ce(f)?void 0:v,newSelectedKeys:y})}function Ht(i,v,f){const y=new Set(me.value);i.forEach(N=>{v?y.add(N):y.delete(N),at(N)});const b=[...y];he(b),Ce({targetKey:f,targetExpanded:ce(f)?void 0:v,newExpandedKeys:b})}function tt(i,v,f){const y=P.value.get(v);if(!y)return;const[b,N]=qe({node:y,checked:i,checkedKeys:ve.value,indeterminateKeys:ue.value,checkStrictly:c.value});J(b,N),x({targetKey:v,targetChecked:i,newCheckedKeys:b,newIndeterminateKeys:N,event:f})}function xt(i,v){if(!P.value.get(i))return;let y,b;if(s.value){const N=new Set(fe.value);b=!N.has(i),b?N.add(i):N.delete(i),y=[...N]}else b=!0,y=[i];Oe(y),ge({targetKey:i,targetSelected:b,newSelectedKeys:y,event:v})}function nt(i,v,f){if(de.value.includes(v)||!P.value.get(v))return;const b=new Set(me.value);i?b.add(v):b.delete(v);const N=[...b];he(N),G.value&&de.value.push(v),Ce({targetKey:v,targetExpanded:i,newExpandedKeys:N,event:f})}function at(i){const v=de.value.indexOf(i);de.value.splice(v,1)}const Ut=m(()=>o!=null&&o.value?async i=>{if(!$e(o.value))return;const v=P.value.get(i);if(!v)return;const{treeNodeData:f}=v;X.value=[...new Set([...X.value,i])];try{await o.value(f),X.value=X.value.filter(y=>y!==i),nt(!0,i),ve.value.includes(i)&&tt(!0,i)}catch(y){X.value=X.value.filter(b=>b!==i),console.error("[tree]load data error: ",y)}}:void 0),lt=ee({treeProps:e,switcherIcon:ie,loadingIcon:p,dragIcon:S,nodeIcon:z,nodeTitle:ae,nodeExtra:Le,treeData:_e,flattenTreeData:Pe,key2TreeNode:P,checkedKeys:ve,indeterminateKeys:ue,selectedKeys:fe,expandedKeys:me,loadingKeys:X,currentExpandKeys:de,onLoadMore:Ut,filterTreeNode:V,onCheck:tt,onSelect:xt,onExpand:nt,onExpandEnd:at,allowDrop(i,v){const f=P.value.get(i);return f&&$e(Y.value)?!!Y.value({dropNode:f.treeNodeData,dropPosition:v}):!0},onDragStart(i,v){const f=P.value.get(i);ye.value=f,f&&t("dragStart",v,f.treeNodeData)},onDragEnd(i,v){const f=P.value.get(i);ye.value=void 0,f&&t("dragEnd",v,f.treeNodeData)},onDragOver(i,v){const f=P.value.get(i);f&&t("dragOver",v,f.treeNodeData)},onDragLeave(i,v){const f=P.value.get(i);f&&t("dragLeave",v,f.treeNodeData)},onDrop(i,v,f){const y=P.value.get(i);ye.value&&y&&!(y.key===ye.value.key||y.pathParentKeys.includes(ye.value.key||""))&&t("drop",{e:f,dragNode:ye.value.treeNodeData,dropNode:y.treeNodeData,dropPosition:v})}});return gn(Ot,lt),{classNames:Q,visibleTreeNodeList:et,treeContext:lt,virtualListRef:O(),computedSelectedKeys:fe,computedExpandedKeys:me,computedCheckedKeys:ve,computedIndeterminateKeys:ue,getPublicCheckedKeys:w,getNodes:B,internalCheckNodes:zt,internalSetCheckedKeys:jt,internalSelectNodes:Rt,internalSetSelectedKeys:At,internalExpandNodes:Ht,internalSetExpandedKeys:Mt}},methods:{toggleCheck(e,t){const{key2TreeNode:n,onCheck:a,checkedKeys:l}=this.treeContext,s=!l.includes(e),o=n.get(e);o&&Se(o)&&a(s,e,t)},scrollIntoView(e){this.virtualListRef&&this.virtualListRef.scrollTo(e)},getSelectedNodes(){return this.getNodes(this.computedSelectedKeys)},getCheckedNodes(e={}){const{checkedStrategy:t,includeHalfChecked:n}=e,a=this.getPublicCheckedKeys(this.computedCheckedKeys,t);return[...this.getNodes(a),...n?this.getHalfCheckedNodes():[]]},getHalfCheckedNodes(){return this.getNodes(this.computedIndeterminateKeys)},getExpandedNodes(){return this.getNodes(this.computedExpandedKeys)},checkAll(e=!0){const{key2TreeNode:t}=this.treeContext,n=e?[...t.keys()].filter(a=>{const l=t.get(a);return l&&Se(l)}):[];this.internalSetCheckedKeys(n)},checkNode(e,t=!0,n=!1){const{checkStrictly:a,treeContext:l}=this,{key2TreeNode:s}=l,o=Te(e),c=(o?e:[e]).filter(r=>{const u=s.get(r);return u&&Se(u)&&(a||!n||Kn(u))});this.internalCheckNodes(c,t,o?void 0:e)},selectAll(e=!0){const{key2TreeNode:t}=this.treeContext,n=e?[...t.keys()].filter(a=>{const l=t.get(a);return l&&He(l)}):[];this.internalSetSelectedKeys(n)},selectNode(e,t=!0){const{key2TreeNode:n}=this.treeContext,a=Te(e),l=(a?e:[e]).filter(s=>{const o=n.get(s);return o&&He(o)});this.internalSelectNodes(l,t,a?void 0:e)},expandAll(e=!0){const{key2TreeNode:t}=this.treeContext,n=e?[...t.keys()].filter(a=>{const l=t.get(a);return l&&st(l)}):[];this.internalSetExpandedKeys(n)},expandNode(e,t=!0){const{key2TreeNode:n}=this.treeContext,a=Te(e),l=(a?e:[e]).filter(s=>{const o=n.get(s);return o&&st(o)});this.internalExpandNodes(l,t,a?void 0:e)}}});function sa(e,t,n,a,l,s){const o=Z("TreeNode"),c=Z("VirtualList");return $(),q("div",{class:R(e.classNames)},[e.virtualListProps?($(),_(c,F({key:0,ref:"virtualListRef"},e.virtualListProps,{data:e.visibleTreeNodeList}),{item:le(({item:r})=>[te(o,F({key:`${e.searchValue}-${r.key}`},r.treeNodeProps),null,16)]),_:1},16,["data"])):($(!0),q(Ve,{key:1},Qe(e.visibleTreeNodeList,r=>($(),_(o,F({key:r.key},r.treeNodeProps),null,16))),128))],2)}var Ae=Ee(ra,[["render",sa]]);const ft=Object.assign(Ae,{install:(e,t)=>{Kt(e,t);const n=wt(t);e.component(n+Ae.name,Ae)}});var ia=Object.defineProperty,ua=Object.defineProperties,da=Object.getOwnPropertyDescriptors,yt=Object.getOwnPropertySymbols,ca=Object.prototype.hasOwnProperty,pa=Object.prototype.propertyIsEnumerable,ht=(e,t,n)=>t in e?ia(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,va=(e,t)=>{for(var n in t||(t={}))ca.call(t,n)&&ht(e,n,t[n]);if(yt)for(var n of yt(t))pa.call(t,n)&&ht(e,n,t[n]);return e},fa=(e,t)=>ua(e,da(t));function ya(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!bn(e)}var ha=oe({name:"TreeSelectPanel",components:{Tree:ft},props:{treeProps:{type:Object,default:()=>({})},selectedKeys:{type:Array},showCheckable:{type:Boolean},treeSlots:{type:Object,default:()=>({})},scrollbar:{type:[Boolean,Object],default:!0}},emits:["change"],setup(e,{emit:t}){const{showCheckable:n,selectedKeys:a,treeProps:l,scrollbar:s}=ne(e),{displayScrollbar:o,scrollbarProps:c}=tn(s),r=De("tree-select"),u=O(),d=m(()=>fa(va({},l.value),{disableSelectActionOnly:!0,checkedKeys:n.value?a.value:[],selectedKeys:n.value?[]:a.value})),h=(g,D)=>{var E,T;n.value?(T=(E=u.value)==null?void 0:E.toggleCheck)==null||T.call(E,g[0],D):t("change",g)},k=g=>{t("change",g)},C=()=>te(ft,F({ref:u},d.value,{onSelect:h,onCheck:k}),e.treeSlots);return()=>{if(o.value){let g;return te(nn,F({class:`${r}-tree-wrapper`},c.value),ya(g=C())?g:{default:()=>[g]})}return te("div",{class:`${r}-tree-wrapper`},[C()])}}}),ga=Object.defineProperty,ba=Object.defineProperties,ma=Object.getOwnPropertyDescriptors,gt=Object.getOwnPropertySymbols,ka=Object.prototype.hasOwnProperty,Sa=Object.prototype.propertyIsEnumerable,bt=(e,t,n)=>t in e?ga(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mt=(e,t)=>{for(var n in t||(t={}))ka.call(t,n)&&bt(e,n,t[n]);if(gt)for(var n of gt(t))Sa.call(t,n)&&bt(e,n,t[n]);return e},Ca=(e,t)=>ba(e,ma(t));function Je(e){return Ge(e)}function Lt(e){return e!=null&&e!==""}function Xe(e){return Je(e)?e.value:e}function Na(e){return Je(e)?e.label:void 0}function kt(e){const t=Xe(e);return Lt(t)}function St(e){return e.map(Xe).filter(Lt)}function Ka(e){var t;const{defaultValue:n,modelValue:a,key2TreeNode:l,multiple:s,treeCheckable:o,fallbackOption:c,fieldNames:r}=ne(e);function u(K){const V=(Te(K)?K:[K]).filter(kt);return s!=null&&s.value||o!=null&&o.value?V:V.slice(0,1)}function d(K,V){const A=[],Y=K?K.filter(kt):[];if(Y.length){const H=new Map;V==null||V.forEach(L=>{H.set(L.value,L)}),Y.forEach(L=>{var re,se,pe,G,M;const Q=Xe(L),ie=H.get(Q),p=l.value.get(Q);let S=null;const z=((re=r==null?void 0:r.value)==null?void 0:re.title)||"title";if(!p){const ae=$e(c==null?void 0:c.value)?c==null?void 0:c.value(Q):c==null?void 0:c.value;if(ae===!1)return;Ge(ae)&&(S=ae)}A.push(Ca(mt(mt({},Je(L)?L:{}),ie||{}),{value:Q,label:(M=(G=(pe=(se=Na(L))!=null?se:p==null?void 0:p.title)!=null?pe:ie==null?void 0:ie.label)!=null?G:S==null?void 0:S[z])!=null?M:Q}))})}return A}const h=O(),k=O();Be(()=>{var K;const V=(a==null?void 0:a.value)!==void 0,A=u((K=a==null?void 0:a.value)!=null?K:[]),Y=St(A);k.value=V?d(Y,d(A)):void 0,h.value=V?Y:void 0});const C=u((t=n==null?void 0:n.value)!=null?t:[]),g=St(C),D=d(g,d(C)),E=O(g||[]),T=O(D);rt(E,()=>{T.value=d(E.value,D)}),rt([h,k],([K,V])=>{E.value=K||[],T.value=V||[]});const j=m(()=>{var K;return(K=h.value)!=null?K:E.value}),W=m(()=>{var K;return(K=k.value)!=null?K:T.value});return{selectedKeys:j,selectedValue:W,setLocalSelectedKeys(K){E.value=K},localSelectedKeys:E,localSelectedValue:T}}function wa(e){const{searchValue:t,flattenTreeData:n,filterMethod:a,disableFilter:l,fieldNames:s}=ne(e),o=m(()=>{var g;return((g=s.value)==null?void 0:g.key)||"key"}),c=(g,D)=>{const E=D[o.value];return!ce(E)&&String(E).indexOf(g)>-1},r=m(()=>(a==null?void 0:a.value)||c),u=O(),d=m(()=>!!t.value),h=m(()=>!(l!=null&&l.value)&&d.value&&u.value&&u.value.size===0),k=m(()=>l!=null&&l.value?void 0:g=>{var D,E;if(!d.value)return!0;const T=g[o.value];return(E=(D=u.value)==null?void 0:D.has(T||""))!=null?E:!1}),C=an((g,D)=>{const E=g.filter(j=>r.value(D,j.treeNodeData)),T=new Set;E.forEach(j=>{T.add(j.key),j.pathParentKeys.forEach(W=>{T.add(W)})}),u.value=T},100);return Be(()=>{l!=null&&l.value?u.value=void 0:C(n.value,t.value)}),{isEmptyFilterResult:h,filterTreeNode:k}}function $a(e,t){const n=`${t}-slot-`;return Object.keys(e).reduce((l,s)=>{if(s.startsWith(n)){const o=s.slice(n.length);o&&(l[o]=e[s])}return l},{})}var Ea=Object.defineProperty,Da=Object.defineProperties,Pa=Object.getOwnPropertyDescriptors,Ct=Object.getOwnPropertySymbols,Oa=Object.prototype.hasOwnProperty,Ta=Object.prototype.propertyIsEnumerable,Nt=(e,t,n)=>t in e?Ea(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_t=(e,t)=>{for(var n in t||(t={}))Oa.call(t,n)&&Nt(e,n,t[n]);if(Ct)for(var n of Ct(t))Ta.call(t,n)&&Nt(e,n,t[n]);return e},Ft=(e,t)=>Da(e,Pa(t));const Va=oe({name:"TreeSelect",components:{Trigger:ln,SelectView:on,Panel:ha,Empty:rn,Spin:sn},inheritAttrs:!1,props:{disabled:{type:Boolean},loading:{type:Boolean},error:{type:Boolean},size:{type:String},border:{type:Boolean,default:!0},allowSearch:{type:[Boolean,Object],default:e=>!!e.multiple},allowClear:{type:Boolean},placeholder:{type:String},maxTagCount:{type:Number},multiple:{type:Boolean},defaultValue:{type:[String,Number,Array,Object]},modelValue:{type:[String,Number,Array,Object]},fieldNames:{type:Object},data:{type:Array,default:()=>[]},labelInValue:{type:Boolean},treeCheckable:{type:Boolean},treeCheckStrictly:{type:Boolean},treeCheckedStrategy:{type:String,default:"all"},treeProps:{type:Object},triggerProps:{type:Object},popupVisible:{type:Boolean,default:void 0},defaultPopupVisible:{type:Boolean},dropdownStyle:{type:Object},dropdownClassName:{type:[String,Array]},filterTreeNode:{type:Function},loadMore:{type:Function},disableFilter:{type:Boolean},popupContainer:{type:[String,Object]},fallbackOption:{type:[Boolean,Function],default:!0},selectable:{type:[Boolean,String,Function],default:!0},scrollbar:{type:[Boolean,Object],default:!0},showHeaderOnEmpty:{type:Boolean,default:!1},showFooterOnEmpty:{type:Boolean,default:!1}},emits:{change:e=>!0,"update:modelValue":e=>!0,"popup-visible-change":e=>!0,"update:popupVisible":e=>!0,search:e=>!0,clear:()=>!0},setup(e,{emit:t,slots:n}){var a,l,s;const{defaultValue:o,modelValue:c,multiple:r,popupVisible:u,defaultPopupVisible:d,treeCheckable:h,treeCheckStrictly:k,data:C,fieldNames:g,disabled:D,labelInValue:E,filterTreeNode:T,disableFilter:j,dropdownStyle:W,treeProps:K,fallbackOption:V,selectable:A,dropdownClassName:Y}=ne(e),{mergedDisabled:H,eventHandlers:L}=un({disabled:D}),re=De("tree-select"),se=$t(dn,void 0),pe=(s=(l=se==null?void 0:(a=se.slots).empty)==null?void 0:l.call(a,{component:"tree-select"}))==null?void 0:s[0],G=m(()=>r.value||h.value),M=(w,B)=>{var x;return A.value==="leaf"?B.isLeaf:$e(A.value)?A.value(w,B):(x=A.value)!=null?x:!1},Q=m(()=>h.value?M:!1),ie=m(()=>Ge(e.allowSearch)&&!!e.allowSearch.retainInputValue),{flattenTreeData:p,key2TreeNode:S}=It(ee({treeData:C,fieldNames:g,selectable:M,checkable:Q})),{selectedKeys:z,selectedValue:ae,setLocalSelectedKeys:Le,localSelectedKeys:_e,localSelectedValue:Pe}=Ka(ee({defaultValue:o,modelValue:c,key2TreeNode:S,multiple:r,treeCheckable:h,treeCheckStrictly:k,fallbackOption:V,fieldNames:g}));function P(w){return h.value?Se(w):He(w)}const ve=m(()=>ce(ae.value)?[]:G.value&&!H.value?ae.value.map(w=>{const B=S.value.get(w.value);return Ft(_t({},w),{closable:!B||P(B)})}):ae.value),ue=w=>{Le(w),Sn(()=>{var B,x;const ge=(E.value?Pe.value:_e.value)||[],Ce=G.value?ge:ge[0];t("update:modelValue",Ce),t("change",Ce),(x=(B=L.value)==null?void 0:B.onChange)==null||x.call(B)})},J=O(""),[fe,Oe]=ze(d.value,ee({value:u})),X=w=>{w!==fe.value&&(Oe(w),t("popup-visible-change",w),t("update:popupVisible",w)),w||he.value&&he.value.blur&&he.value.blur()},{isEmptyFilterResult:ye,filterTreeNode:Fe}=wa(ee({searchValue:J,flattenTreeData:p,filterMethod:T,disableFilter:j,fieldNames:g})),me=m(()=>!p.value.length||ye.value),he=O(),de=m(()=>{var w;return[(W==null?void 0:W.value)||{},(w=K==null?void 0:K.value)!=null&&w.virtualListProps?{"max-height":"unset"}:{}]});return{refSelectView:he,prefixCls:re,TreeSelectEmpty:pe,selectedValue:ae,selectedKeys:z,mergedDisabled:H,searchValue:J,panelVisible:fe,isEmpty:me,computedFilterTreeNode:Fe,isMultiple:G,selectViewValue:ve,computedDropdownStyle:de,onSearchValueChange(w){w!==J.value&&(X(!0),J.value=w,t("search",w))},onSelectChange(w){ue(w),J.value="",G.value||X(!1)},onVisibleChange:X,onInnerClear(){ue([]),t("clear")},pickSubCompSlots:$a,isSelectable:M,isCheckable:Q,onBlur:()=>{!ie.value&&J.value&&(J.value="")},onItemRemove(w){if(H.value)return;const B=S.value.get(w);if(h.value&&B){if(P(B)){const[x]=qe({node:B,checked:!1,checkedKeys:z.value,indeterminateKeys:[],checkStrictly:k.value});ue(x)}}else{const x=z.value.filter(ge=>ge!==w);ue(x)}}}}});function Ba(e,t,n,a,l,s){const o=Z("SelectView"),c=Z("Spin"),r=Z("Panel"),u=Z("Trigger");return $(),_(u,F({class:`${e.prefixCls}-trigger`,"auto-fit-popup-min-width":"",trigger:"click",position:"bl","popup-offset":4,"animation-name":"slide-dynamic-origin","prevent-focus":!0},e.triggerProps,{disabled:e.mergedDisabled,"popup-visible":e.panelVisible,"popup-container":e.popupContainer,"click-to-close":!e.allowSearch,"auto-fit-transform-origin":"",onPopupVisibleChange:e.onVisibleChange}),{content:le(()=>[we("div",{class:R([`${e.prefixCls}-popup`,{[`${e.prefixCls}-has-header`]:!!e.$slots.header,[`${e.prefixCls}-has-footer`]:!!e.$slots.footer},e.dropdownClassName]),style:Et(e.computedDropdownStyle)},[e.$slots.header&&(!e.isEmpty||e.showHeaderOnEmpty)?($(),q("div",{key:0,class:R(`${e.prefixCls}-header`)},[U(e.$slots,"header")],2)):I("v-if",!0),e.loading?U(e.$slots,"loader",{key:1},()=>[te(c)]):e.isEmpty?U(e.$slots,"empty",{key:2},()=>[($(),_(mn(e.TreeSelectEmpty?e.TreeSelectEmpty:"Empty")))]):($(),_(r,{key:3,"selected-keys":e.selectedKeys,"show-checkable":e.treeCheckable,scrollbar:e.scrollbar,"tree-props":Ft(_t({actionOnNodeClick:e.selectable==="leaf"?"expand":void 0,blockNode:!0},e.treeProps),{data:e.data,checkStrictly:e.treeCheckStrictly,checkedStrategy:e.treeCheckedStrategy,fieldNames:e.fieldNames,multiple:e.multiple,loadMore:e.loadMore,filterTreeNode:e.computedFilterTreeNode,size:e.size,checkable:e.isCheckable,selectable:e.isSelectable,searchValue:e.searchValue}),"tree-slots":e.pickSubCompSlots(e.$slots,"tree"),onChange:e.onSelectChange},null,8,["selected-keys","show-checkable","scrollbar","tree-props","tree-slots","onChange"])),e.$slots.footer&&(!e.isEmpty||e.showFooterOnEmpty)?($(),q("div",{key:4,class:R(`${e.prefixCls}-footer`)},[U(e.$slots,"footer")],2)):I("v-if",!0)],6)]),default:le(()=>[U(e.$slots,"trigger",{},()=>[te(o,F({ref:"refSelectView","model-value":e.selectViewValue,"input-value":e.searchValue,"allow-search":!!e.allowSearch,"allow-clear":e.allowClear,loading:e.loading,size:e.size,"max-tag-count":e.maxTagCount,disabled:e.mergedDisabled,opened:e.panelVisible,error:e.error,bordered:e.border,placeholder:e.placeholder,multiple:e.isMultiple},e.$attrs,{onInputValueChange:e.onSearchValueChange,onClear:e.onInnerClear,onRemove:e.onItemRemove,onBlur:e.onBlur}),Dt({_:2},[e.$slots.prefix?{name:"prefix",fn:le(()=>[U(e.$slots,"prefix")])}:void 0,e.$slots.label?{name:"label",fn:le(d=>[U(e.$slots,"label",Re(kn(d)))])}:void 0]),1040,["model-value","input-value","allow-search","allow-clear","loading","size","max-tag-count","disabled","opened","error","bordered","placeholder","multiple","onInputValueChange","onClear","onRemove","onBlur"])])]),_:3},16,["class","disabled","popup-visible","popup-container","click-to-close","onPopupVisibleChange"])}var Me=Ee(Va,[["render",Ba]]);const Ia=Object.assign(Me,{install:(e,t)=>{Kt(e,t);const n=wt(t);e.component(n+Me.name,Me)}});const Ma=oe({name:"Select",__name:"index",props:{modelValue:{default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,a=m({get:()=>n.modelValue,set:l=>{t("update:modelValue",l)}});return(l,s)=>{const o=Ia;return $(),_(cn,null,{default:le(()=>[te(o,F({modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=c=>a.value=c)},l.$attrs),null,16,["modelValue"])]),_:1})}}});export{Ma as default};
